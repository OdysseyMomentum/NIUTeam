{"remainingRequest":"/Users/erfalk/ws_filedgr/filedgr-streams-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/erfalk/ws_filedgr/filedgr-streams-front/src/components/Details.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/erfalk/ws_filedgr/filedgr-streams-front/src/components/Details.vue","mtime":1605127685904},{"path":"/Users/erfalk/ws_filedgr/filedgr-streams-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/erfalk/ws_filedgr/filedgr-streams-front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/erfalk/ws_filedgr/filedgr-streams-front/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/Users/erfalk/ws_filedgr/filedgr-streams-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/erfalk/ws_filedgr/filedgr-streams-front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmltcG9ydCAnbGVhZmxldC9kaXN0L2xlYWZsZXQuY3NzJwppbXBvcnQgTGluZUNoYXJ0IGZyb20gJ0AvY29tcG9uZW50cy9wbG90cy9MaW5lQ2hhcnQudnVlJwppbXBvcnQgTWFwIGZyb20gJ0AvY29tcG9uZW50cy9NYXAudnVlJwppbXBvcnQgV2VhdGhlciBmcm9tICdAL2NvbXBvbmVudHMvV2VhdGhlci52dWUnCmltcG9ydCB7Q29tcG9uZW50LCBWdWV9IGZyb20gJ3Z1ZS1wcm9wZXJ0eS1kZWNvcmF0b3InCmltcG9ydCB7SURvY3VtZW50TWV0YSwgSVJlc291cmNlVHlwZX0gZnJvbSAnQC90eXBlcy9SZXNvdXJjZVR5cGUnCmltcG9ydCB7SU9iamVjdFR5cGV9IGZyb20gJ0AvdHlwZXMvT2JqZWN0VHlwZScKaW1wb3J0IHtJVXNlclR5cGV9IGZyb20gJ0AvdHlwZXMvVXNlclR5cGUnCgpAQ29tcG9uZW50KHsKICBjb21wb25lbnRzOiB7CiAgICBNYXAsCiAgICBXZWF0aGVyLAogICAgTGluZUNoYXJ0CiAgfQp9KQpleHBvcnQgZGVmYXVsdCBjbGFzcyBEZXRhaWxzIGV4dGVuZHMgVnVlIHsKICBwcml2YXRlIG9iamVjdFJlc291cmNlczogSVJlc291cmNlVHlwZVtdCiAgcHJpdmF0ZSBvYmplY3Q6IElPYmplY3RUeXBlCiAgcHJpdmF0ZSByZXJlbmRlcktleSA9IDAKICBwdWJsaWMgc2hvdyA9IGZhbHNlCgogIHByaXZhdGUgc2hvd0NoYXJ0ICgpIHsKICAgIHRoaXMuc2hvdyA9IHRydWUKICAgIHRoaXMucmVyZW5kZXJLZXkgPSAwCiAgfQoKICBjb25zdHJ1Y3RvcigpIHsKICAgIHN1cGVyKCkKICAgIHRoaXMub2JqZWN0UmVzb3VyY2VzID0gdGhpcy4kc3RvcmUuc3RhdGUucmVzb3VyY2VzCiAgICB0aGlzLm9iamVjdCA9IHRoaXMuJHN0b3JlLnN0YXRlLm9iamVjdAogIH0KCiAgcHJpdmF0ZSBhc3luYyBzdGFydERvd25sb2FkKHJlc291cmNlSWQ6IHN0cmluZykgewogICAgY29uc29sZS5sb2coJ0Rvd25sb2FkaW5nOiAnICsgcmVzb3VyY2VJZCkKICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXdhaXQgdGhpcy4kYXV0aC5nZXRUb2tlblNpbGVudGx5KCkKICAgIGZldGNoKGVuY29kZVVSSSgnL2FwaS9yZXNvdXJjZS9nZXQnKSwgewogICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgaGVhZGVyczogewogICAgICAgIEF1dGhvcml6YXRpb246ICdCZWFyZXIgJyArIGFjY2Vzc1Rva2VuCiAgICAgIH0sCiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICBvYmplY3Q6IHsKICAgICAgICAgIHVvaTogdGhpcy5vYmplY3QudW9pCiAgICAgICAgfSwKICAgICAgICByZXNvdXJjZTogewogICAgICAgICAgcmVzb3VyY2VJZDogcmVzb3VyY2VJZAogICAgICAgIH0KCiAgICAgIH0pCiAgICB9KS50aGVuKGFzeW5jIHJlc3BvbnNlID0+IHsKICAgICAgY29uc3QgcmVzb3VyY2U6IElSZXNvdXJjZVR5cGUgPSBhd2FpdCByZXNwb25zZS5qc29uKCkgYXMgSVJlc291cmNlVHlwZQogICAgICBjb25zdCByZXNvdXJjZU1ldGEgPSByZXNvdXJjZS5tZXRhIGFzIElEb2N1bWVudE1ldGEKCiAgICAgIGlmIChyZXNvdXJjZU1ldGEuYWNjZXNzICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBpZiAocmVzb3VyY2VNZXRhLmZpbGV0eXBlID09PSAnLmpwZycgfHwKICAgICAgICAgIHJlc291cmNlTWV0YS5maWxldHlwZSA9PT0gJy5qcGVnJyB8fAogICAgICAgICAgcmVzb3VyY2VNZXRhLmZpbGV0eXBlID09PSAnLnBuZycgfHwKICAgICAgICAgIHJlc291cmNlTWV0YS5maWxldHlwZSA9PT0gJy5wZGYnIHx8CiAgICAgICAgICByZXNvdXJjZU1ldGEuZmlsZXR5cGUgPT09ICcuc3ZnJykgewogICAgICAgICAgd2luZG93Lm9wZW4ocmVzb3VyY2VNZXRhLmFjY2VzcywgJ19ibGFuaycpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHdpbmRvdy5vcGVuKHJlc291cmNlTWV0YS5hY2Nlc3MpCiAgICAgICAgfQogICAgICB9CiAgICB9KQogICAgICAuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RoZXJlIHdhcyBhbiBlcnJvciEnLCBlcnJvcikKICAgICAgfSkKICB9CgogIHByaXZhdGUgZ2V0RG9jdW1lbnRzKCk6IElSZXNvdXJjZVR5cGVbXSB7CiAgICByZXR1cm4gdGhpcy5vYmplY3RSZXNvdXJjZXMuZmlsdGVyKHIgPT4gKHIucmVzb3VyY2VUeXBlID09PSAnRE9DVU1FTlQnICYmIHIubWV0YSAhPSBudWxsKSkKICB9CgogIHByaXZhdGUgZ2V0U2Vuc29ycygpOiBJUmVzb3VyY2VUeXBlW10gewogICAgcmV0dXJuIHRoaXMub2JqZWN0UmVzb3VyY2VzLmZpbHRlcihyID0+IChyLnJlc291cmNlVHlwZSA9PT0gJ1NFTlNPUicpKQogIH0KfQo="},{"version":3,"sources":["Details.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Details.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"card info\">\n    <Map/>\n    <div class=\"card-content\">\n      <p class=\"title\">\n        {{ this.object.displayName }}\n      </p>\n      <b-tabs type=\"is-boxed\">\n        <b-tab-item label=\"Object\" icon=\"home\">\n          <fieldset>\n            <div class=\"columns is-mobile is-multiline\">\n              <div class=\"column is-full pt-0\">\n                <label><strong>UOI</strong></label\n                ><input class=\"input\" readonly v-model=\"this.object.uoi\"/>\n              </div>\n              <div class=\"column is-full pt-0\">\n                <label><strong>Description</strong></label\n                ><input readonly class=\"input\" v-model=\"this.object.description\"/>\n              </div>\n              <div class=\"column is-four-fifths pt-0\">\n                <label><strong>Street Name</strong></label\n                ><input\n                name=\"street\"\n                class=\"input\"\n                readonly\n                v-model=\"this.object.streetName\"\n              />\n              </div>\n              <div class=\"column is-one-fifths pt-0\">\n                <label><strong>Number</strong></label\n                ><input class=\"input\" readonly v-model=\"this.object.streetNumber\"/>\n              </div>\n              <div class=\"column is-four-fifths pt-0 pt-0\">\n                <label><strong>City</strong></label\n                ><input class=\"input\" readonly v-model=\"this.object.city\"/>\n              </div>\n              <div class=\"column is-one-fifths pt-0\">\n                <label><strong>Zipcode</strong></label\n                ><input class=\"input\" readonly v-model=\"this.object.zipcode\"/>\n              </div>\n              <div class=\"column is-full pt-0\">\n                <label><strong>Country</strong></label\n                ><input class=\"input\" readonly v-model=\"this.object.country\"/>\n              </div>\n            </div>\n          </fieldset>\n        </b-tab-item>\n        <b-tab-item label=\"Sensors\" icon=\"leak\">\n          <b-tabs vertical>\n            <b-tab-item @click=\"showChart()\" v-for=\"resources in this.getSensors()\" :key=\"resources.resourceId\" :label=resources.displayName></b-tab-item>\n            <!-- <a class=\"panel-block\" @click=\"showChart()\" v-for=\"resources in this.getSensors()\" :key=\"resources.resourceId\" :label=resources.displayName>{{ resources.displayName }}</a> -->\n            <LineChart/>\n          </b-tabs>\n        </b-tab-item>\n        \n            <b-tab-item label=\"Documents\" icon=\"file-document-outline\">\n              <a class=\"panel-block\" v-for=\"resources in this.getDocuments()\"\n                 :key=\"resources.resourceId\"\n                 :href=\"resources.meta.access\"\n                 @click=\"startDownload( resources.resourceId )\">\n                <b-icon v-if=\"resources.meta.filetype === '.pdf'\" icon=\"file-pdf-box\" aria-hidden=\"true\"/>\n                <b-icon v-else-if=\"resources.meta.filetype === '.docx' || resources.meta.filetype === '.doc'\"\n                        icon=\"file-word-box\" aria-hidden=\"true\"/>\n                <b-icon v-else-if=\"resources.meta.filetype === '.xlsx' || resources.meta.filetype === '.xlsx'\"\n                        icon=\"file-excel-box\" aria-hidden=\"true\"/>\n                <b-icon v-else-if=\"resources.meta.filetype === '.pptx' || resources.meta.filetype === '.ppt'\"\n                        icon=\"file-powerpoint-box\" aria-hidden=\"true\"/>\n                <b-icon v-else-if=\"resources.meta.filetype === '.png' || resources.meta.filetype === '.jpg'\"\n                        icon=\"file-image\" aria-hidden=\"true\"/>\n                {{ resources.meta.filename }} {{ resources.meta.filesize | prettyBytes(2, false, 'MB') }}\n              </a>\n            </b-tab-item>\n            <b-tab-item label=\"Weather\" icon=\"weather-partly-cloudy\"><Weather/></b-tab-item>\n          </b-tabs>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport 'leaflet/dist/leaflet.css'\nimport LineChart from '@/components/plots/LineChart.vue'\nimport Map from '@/components/Map.vue'\nimport Weather from '@/components/Weather.vue'\nimport {Component, Vue} from 'vue-property-decorator'\nimport {IDocumentMeta, IResourceType} from '@/types/ResourceType'\nimport {IObjectType} from '@/types/ObjectType'\nimport {IUserType} from '@/types/UserType'\n\n@Component({\n  components: {\n    Map,\n    Weather,\n    LineChart\n  }\n})\nexport default class Details extends Vue {\n  private objectResources: IResourceType[]\n  private object: IObjectType\n  private rerenderKey = 0\n  public show = false\n\n  private showChart () {\n    this.show = true\n    this.rerenderKey = 0\n  }\n\n  constructor() {\n    super()\n    this.objectResources = this.$store.state.resources\n    this.object = this.$store.state.object\n  }\n\n  private async startDownload(resourceId: string) {\n    console.log('Downloading: ' + resourceId)\n    const accessToken = await this.$auth.getTokenSilently()\n    fetch(encodeURI('/api/resource/get'), {\n      method: 'POST',\n      headers: {\n        Authorization: 'Bearer ' + accessToken\n      },\n      body: JSON.stringify({\n        object: {\n          uoi: this.object.uoi\n        },\n        resource: {\n          resourceId: resourceId\n        }\n\n      })\n    }).then(async response => {\n      const resource: IResourceType = await response.json() as IResourceType\n      const resourceMeta = resource.meta as IDocumentMeta\n\n      if (resourceMeta.access !== undefined) {\n        if (resourceMeta.filetype === '.jpg' ||\n          resourceMeta.filetype === '.jpeg' ||\n          resourceMeta.filetype === '.png' ||\n          resourceMeta.filetype === '.pdf' ||\n          resourceMeta.filetype === '.svg') {\n          window.open(resourceMeta.access, '_blank')\n        } else {\n          window.open(resourceMeta.access)\n        }\n      }\n    })\n      .catch(error => {\n        console.error('There was an error!', error)\n      })\n  }\n\n  private getDocuments(): IResourceType[] {\n    return this.objectResources.filter(r => (r.resourceType === 'DOCUMENT' && r.meta != null))\n  }\n\n  private getSensors(): IResourceType[] {\n    return this.objectResources.filter(r => (r.resourceType === 'SENSOR'))\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.card-content {\n  text-align: left;\n}\n</style>\n"]}]}